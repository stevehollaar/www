var DashboardHeaderView=Backbone.View.extend({activeTimeFrame_:null,events:{"click .timeframe button":"changeTimeFrame_"},initialize:function(){this.activeTimeFrame_=DashboardHeaderView.TIMEFRAMES.day},render:function(){},changeTimeFrame_:function(e){var i=$(e.currentTarget);this.$el.find(".timeframe button").removeClass("active"),i.addClass("active"),this.trigger("changeTimeFrame",i.data("timeframe"))}});DashboardHeaderView.TIMEFRAMES={day:0,week:1,month:2,year:3,custom:4};var DashboardSectionView=Backbone.View.extend({expanded_:!1,initialize:function(){this.listenTo(this.colection,"updated",this.render.bind(this))},render:function(){this.el.innerHTML=Templates.DashboardSection()}}),FoursquareCheckinsView=DashboardSectionView.extend({initialize:function(){this.listenTo(this.collection,"updated",this.render.bind(this))},render:function(){this.el.innerHTML=Templates.FoursquareCheckins({checkins:this.collection.toJSON()})}}),DashboardView=Backbone.View.extend({dashboardHeaderView_:null,foursquareCheckinsView_:null,initialize:function(){this.dashboardHeaderView_=new DashboardHeaderView({el:this.el.querySelector("header")}),this.dashboardHeaderView_.on("changeTimeFrame",function(e){console.log(e)});var e=this.el.querySelector(".foursquare-checkins");e&&(this.foursquareCheckinsView_=new FoursquareCheckinsView({el:e,collection:this.model.get("foursquareCheckins")}))},render:function(){this.foursquareCheckinsView_&&this.foursquareCheckinsView_.render()}}),ExperimentsView=Backbone.View.extend({render:function(){console.log("experiments view render")}}),AppView=Backbone.View.extend({headerView_:null,mainView_:null,initialize:function(){this.headerView_=new HeaderView({el:this.el.querySelector("header")}),this.mainView_=new MainView({el:this.el.querySelector("main")})},render:function(){this.headerView_.render(),this.mainView_.render()},activate:function(e){this.mainView_.activate(e)}}),App;$(function(){App=new AppView({el:document.querySelector("body")}),App.render()});var FoursquareCheckinModel=Backbone.Model.extend({"default":{type:null,isMayor:null,timeZoneOffset:null,venue:null},initialize:function(){}}),FoursquareCheckinCollection=Backbone.Collection.extend({model:FoursquareCheckinModel,url:"/api/checkins",initialize:function(){this.fetch()},parse:function(e){this.set(e),this.trigger("updated")}}),DashboardModel=Backbone.Model.extend({defaults:{foursquareCheckins:null},initialize:function(){this.set("foursquareCheckins",new FoursquareCheckinCollection)}}),dateFormats={"short":"DD MMMM - YYYY","long":"ddd MMM DD, YYYY h:mma"};Handlebars.registerHelper("formatDate",function(e,i){return f=dateFormats[i],moment(e).format(f)}),Handlebars.registerHelper("formatSecondsDate",function(e,i){return f=dateFormats[i],moment(1e3*e).format(f)});var HeaderView=Backbone.View.extend({events:{'click nav li:not(".active")':"navClickEvt_"},initialize:function(){},render:function(){},navClickEvt_:function(e){$("nav li").removeClass("active");var i=$(e.currentTarget);i.addClass("active"),App.activate(i.data("page"))}}),MainView=Backbone.View.extend({dashboardView_:null,experimentsView_:null,initialize:function(){this.dashboardView_=new DashboardView({el:this.el.querySelector(".dashboard"),model:new DashboardModel}),this.experimentsView_=new ExperimentsView({el:this.el.querySelector(".experiments")})},render:function(){switch(document.location.pathname){case"/experiments":case"/experiments/":this.experimentsView_.render();break;default:this.dashboardView_.render()}},activate:function(e){switch(e){case"dashboard":this.dashboardView_.$el.show(),this.experimentsView_.$el.hide();break;case"experiments":this.dashboardView_.$el.hide(),this.experimentsView_.$el.show()}}});